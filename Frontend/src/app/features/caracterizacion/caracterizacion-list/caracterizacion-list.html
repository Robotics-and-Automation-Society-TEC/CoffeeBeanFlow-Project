<div class="list-container">
  <a routerLink="/" class="btn-home">
    üè† Volver a Inicio
  </a>
  
  <div class="header">
    <h2>Gesti√≥n de Caracterizaci√≥n</h2>
    <button class="btn-primary" (click)="nuevoRegistro()">+ Nueva Caracterizaci√≥n</button>
  </div>

  <div *ngIf="cargando" class="loading">Cargando registros...</div>

  <div *ngIf="!cargando && caracterizaciones.length === 0" class="empty-state">
    <p>No hay registros de caracterizaci√≥n a√∫n</p>
    <button class="btn-primary" (click)="nuevoRegistro()">Crear el primero</button>
  </div>

  <div *ngIf="!cargando && caracterizaciones.length > 0" class="cards-grid">
    <div class="caracterizacion-card" *ngFor="let caract of caracterizaciones">
      <div class="card-header">
        <span class="id-text">LOTE: {{ caract.nloteAreaAcopio }}</span>
        <span class="estado-text">{{ getEstadoCalidad(caract) }}</span>
      </div>

      <div class="card-body">
        <!-- Informaci√≥n General -->
        <div class="info-section">
          <h3 class="section-title">üìã Informaci√≥n General</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Proceso:</td>
              <td class="value-cell">{{ caract.proceso || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Lote Asignado:</td>
              <td class="value-cell">{{ caract.lAsignado || '-' }}</td>
            </tr>
            <tr class="highlight-row">
              <td class="label-cell">Estado Maduraci√≥n:</td>
              <td class="value-cell primary-value">{{ caract.eMaduracion ? (caract.eMaduracion + '%') : '-' }}</td>
            </tr>
          </table>
        </div>

        <!-- Rendimientos -->
        <div class="info-section">
          <h3 class="section-title">üìä Rendimientos y Mediciones</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">DR Maduras:</td>
              <td class="value-cell">{{ caract.drMaduras ? (caract.drMaduras + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Densidad:</td>
              <td class="value-cell">{{ caract.densidad || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">M Tabla:</td>
              <td class="value-cell">{{ caract.mTabla || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Broca:</td>
              <td class="value-cell">{{ caract.broca ? (caract.broca + '%') : '-' }}</td>
            </tr>
          </table>
        </div>

        <!-- Conteos -->
        <div class="info-section">
          <h3 class="section-title">üî¢ Conteos</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Verdes:</td>
              <td class="value-cell">{{ caract.cVerdes || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Objetivo:</td>
              <td class="value-cell">{{ caract.cObjetivo || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Inmaduras:</td>
              <td class="value-cell">{{ caract.cInmaduras || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Sobremaduras:</td>
              <td class="value-cell">{{ caract.cSobremaduras || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Secas:</td>
              <td class="value-cell">{{ caract.cSecas || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Vanos:</td>
              <td class="value-cell">{{ caract.vanos || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Secos:</td>
              <td class="value-cell">{{ caract.secos || 0 }}</td>
            </tr>
          </table>
        </div>

        <!-- Porcentajes -->
        <div class="info-section">
          <h3 class="section-title">üìà Porcentajes</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">PC Debajo:</td>
              <td class="value-cell">{{ caract.pcDebajo ? (caract.pcDebajo + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">PC Verdes:</td>
              <td class="value-cell">{{ caract.pcVerdes ? (caract.pcVerdes + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">PC Secas:</td>
              <td class="value-cell">{{ caract.pcSecas ? (caract.pcSecas + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">PC Encima:</td>
              <td class="value-cell">{{ caract.pcEncima ? (caract.pcEncima + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">PC Objetivo:</td>
              <td class="value-cell">{{ caract.pcObjetivo ? (caract.pcObjetivo + '%') : '-' }}</td>
            </tr>
          </table>
        </div>

        <!-- RC Sobremaduras -->
        <div class="info-section rc-section" *ngIf="caract.rcSobremaduras">
          <h3 class="section-title">üìä RC Sobremaduras</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">GBX:</td>
              <td class="value-cell">{{ caract.rcSobremaduras.gbx || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Promedio:</td>
              <td class="value-cell">{{ caract.rcSobremaduras.promedio || '-' }}</td>
            </tr>
            <tr *ngIf="caract.rcSobremaduras.observaciones">
              <td class="label-cell">Observaciones:</td>
              <td class="value-cell">{{ caract.rcSobremaduras.observaciones }}</td>
            </tr>
          </table>
        </div>

        <!-- RC Inmaduras -->
        <div class="info-section rc-section" *ngIf="caract.rcInmaduras">
          <h3 class="section-title">üìä RC Inmaduras</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">GBX:</td>
              <td class="value-cell">{{ caract.rcInmaduras.gbx || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Promedio:</td>
              <td class="value-cell">{{ caract.rcInmaduras.promedio || '-' }}</td>
            </tr>
            <tr *ngIf="caract.rcInmaduras.observaciones">
              <td class="label-cell">Observaciones:</td>
              <td class="value-cell">{{ caract.rcInmaduras.observaciones }}</td>
            </tr>
          </table>
        </div>

        <!-- RC Maduras -->
        <div class="info-section rc-section" *ngIf="caract.rcMaduras">
          <h3 class="section-title">üìä RC Maduras</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">GBX:</td>
              <td class="value-cell">{{ caract.rcMaduras.gbx || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Promedio:</td>
              <td class="value-cell">{{ caract.rcMaduras.promedio || '-' }}</td>
            </tr>
            <tr *ngIf="caract.rcMaduras.observaciones">
              <td class="label-cell">Observaciones:</td>
              <td class="value-cell">{{ caract.rcMaduras.observaciones }}</td>
            </tr>
          </table>
        </div>
      </div>

      <div class="card-footer">
        <button class="btn-edit" (click)="editarRegistro(caract.tiempo)">‚úèÔ∏è Editar</button>
        <button class="btn-delete" (click)="eliminarRegistro(caract.tiempo)">üóëÔ∏è Eliminar</button>
      </div>
    </div>
  </div>
</div>
