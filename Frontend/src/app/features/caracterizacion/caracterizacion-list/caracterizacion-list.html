<div class="list-container">
  <a routerLink="/" class="btn-home">
    üè† Volver a Inicio
  </a>
  
  <div class="header">
    <h2>Gesti√≥n de Caracterizaci√≥n</h2>
    <button class="btn-primary" (click)="nuevoRegistro()">+ Nueva Caracterizaci√≥n</button>
  </div>

  <div *ngIf="cargando" class="loading">Cargando registros...</div>

  <div *ngIf="!cargando && caracterizaciones.length === 0" class="empty-state">
    <p>No hay registros de caracterizaci√≥n a√∫n</p>
    <button class="btn-primary" (click)="nuevoRegistro()">Crear el primero</button>
  </div>

  <div *ngIf="!cargando && caracterizaciones.length > 0" class="cards-grid">
    <div class="caracterizacion-card" *ngFor="let caract of caracterizaciones">
      <div class="card-header">
        <span class="id-text">LOTE: {{ caract.nloteAreaAcopio }}</span>
        <span class="estado-text">{{ getEstadoCalidad(caract) }}</span>
      </div>

      <div class="card-body">
        <!-- Informaci√≥n General -->
        <div class="info-section">
          <h3 class="section-title">üìã Informaci√≥n General</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Proceso:</td>
              <td class="value-cell">{{ caract.proceso || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Lote Asignado:</td>
              <td class="value-cell">{{ caract.lAsignado || '-' }}</td>
            </tr>
            <tr class="highlight-row">
              <td class="label-cell">Escala de maduras (1-10):</td>
              <td class="value-cell primary-value">{{ caract.emaduracion ? caract.emaduracion : '-' }}</td>
            </tr>
          </table>
        </div>

        <!-- Rendimientos -->
        <div class="info-section">
          <h3 class="section-title">üìä Rendimientos y Mediciones</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Rango √ìptimo de maduras (¬∞ brix):</td>
              <td class="value-cell">{{ caract.dRmaduras ? caract.dRmaduras : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Densidad:</td>
              <td class="value-cell">{{ caract.densidad || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Muestreo tabla:</td>
              <td class="value-cell">{{ caract.mtabla || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Broca:</td>
              <td class="value-cell">{{ caract.broca ? (caract.broca + '%') : '-' }}</td>
            </tr>
          </table>
        </div>

        <!-- Conteos -->
        <div class="info-section">
          <h3 class="section-title">üî¢ Conteos</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Verdes:</td>
              <td class="value-cell">{{ caract.cverdes || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Objetivo:</td>
              <td class="value-cell">{{ caract.cobjetivo || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Inmaduras:</td>
              <td class="value-cell">{{ caract.cinmaduras || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Sobremaduras:</td>
              <td class="value-cell">{{ caract.csobremaduras || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Secas:</td>
              <td class="value-cell">{{ caract.csecas || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Vanos:</td>
              <td class="value-cell">{{ caract.vanos || 0 }}</td>
            </tr>
            <tr>
              <td class="label-cell">Secos:</td>
              <td class="value-cell">{{ caract.secos || 0 }}</td>
            </tr>
          </table>
        </div>

        <!-- Porcentajes -->
        <div class="info-section">
          <h3 class="section-title">üìà Porcentajes</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Cerezas Debajo:</td>
              <td class="value-cell">{{ caract.pCdebajo ? (caract.pCdebajo + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Cerezas Verdes:</td>
              <td class="value-cell">{{ caract.pCverdes ? (caract.pCverdes + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Cerezas Secas:</td>
              <td class="value-cell">{{ caract.pCsecas ? (caract.pCsecas + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Cerezas Encima:</td>
              <td class="value-cell">{{ caract.pCencima ? (caract.pCencima + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Cerezas Objetivo:</td>
              <td class="value-cell">{{ caract.pCobjetivo ? (caract.pCobjetivo + '%') : '-' }}</td>
            </tr>
          </table>
        </div>

        <!-- RC Sobremaduras -->
        <div class="info-section rc-section" *ngIf="caract.rCsobremaduras">
          <h3 class="section-title">üìä RC Sobremaduras</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">GBX:</td>
              <td class="value-cell">{{ caract.rCsobremaduras.gbx || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Promedio:</td>
              <td class="value-cell">{{ caract.rCsobremaduras.promedio || '-' }}</td>
            </tr>
            <tr *ngIf="caract.rCsobremaduras.observaciones">
              <td class="label-cell">Observaciones:</td>
              <td class="value-cell">{{ caract.rCsobremaduras.observaciones }}</td>
            </tr>
          </table>
        </div>

        <!-- RC Inmaduras -->
        <div class="info-section rc-section" *ngIf="caract.rCinmaduras">
          <h3 class="section-title">üìä RC Inmaduras</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">GBX:</td>
              <td class="value-cell">{{ caract.rCinmaduras.gbx || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Promedio:</td>
              <td class="value-cell">{{ caract.rCinmaduras.promedio || '-' }}</td>
            </tr>
            <tr *ngIf="caract.rCinmaduras.observaciones">
              <td class="label-cell">Observaciones:</td>
              <td class="value-cell">{{ caract.rCinmaduras.observaciones }}</td>
            </tr>
          </table>
        </div>

        <!-- RC Maduras -->
        <div class="info-section rc-section" *ngIf="caract.rCmaduras">
          <h3 class="section-title">üìä RC Maduras</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">GBX:</td>
              <td class="value-cell">{{ caract.rCmaduras.gbx || '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Promedio:</td>
              <td class="value-cell">{{ caract.rCmaduras.promedio || '-' }}</td>
            </tr>
            <tr *ngIf="caract.rCmaduras.observaciones">
              <td class="label-cell">Observaciones:</td>
              <td class="value-cell">{{ caract.rCmaduras.observaciones }}</td>
            </tr>
          </table>
        </div>
      </div>

      <div class="card-footer">
        <button class="btn-edit" (click)="editarRegistro(caract.tiempo)">‚úèÔ∏è Editar</button>
        <button class="btn-delete" (click)="eliminarRegistro(caract.tiempo)">üóëÔ∏è Eliminar</button>
      </div>
    </div>
  </div>
</div>
