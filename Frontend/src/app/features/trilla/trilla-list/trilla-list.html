<div class="list-container">
  <a routerLink="/" class="btn-home">
    üè† Volver a Inicio
  </a>
  
  <div class="header">
    <h2>Gesti√≥n de Trilla</h2>
    <button class="btn-primary" (click)="nuevoRegistro()">+ Nueva Trilla</button>
  </div>

  <div *ngIf="cargando" class="loading">Cargando registros...</div>

  <div *ngIf="!cargando && trillas.length === 0" class="empty-state">
    <p>No hay registros de trilla a√∫n</p>
    <button class="btn-primary" (click)="nuevoRegistro()">Crear el primero</button>
  </div>

  <div *ngIf="!cargando && trillas.length > 0" class="cards-grid">
    <div class="trilla-card" *ngFor="let trilla of trillas">
      <div class="card-header">
        <span class="id-text">LOTE: {{ trilla.nlote }}</span>
        <span class="estado-text">{{ getEstadoRendimiento(trilla) }}</span>
      </div>

      <div class="card-body">
        <!-- Humedades y Rendimientos -->
        <div class="info-section">
          <h3 class="section-title">üíß Humedades y Rendimientos</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Humedad Inicial:</td>
              <td class="value-cell">{{ trilla.hinicial ? (trilla.hinicial + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Humedad Final:</td>
              <td class="value-cell">{{ trilla.hfinal ? (trilla.hfinal + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Rend. Final Pelado:</td>
              <td class="value-cell">{{ trilla.rFinalPelado ? (trilla.rFinalPelado + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Rend. Final Selecci√≥n:</td>
              <td class="value-cell">{{ trilla.rFinalSeleccion ? (trilla.rFinalSeleccion + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Rend. Te√≥rico Pelado:</td>
              <td class="value-cell">{{ trilla.rteoricoPelado ? (trilla.rteoricoPelado + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Rend. Te√≥rico Selecci√≥n:</td>
              <td class="value-cell">{{ trilla.rTeoricoSeleccion ? (trilla.rTeoricoSeleccion + '%') : '-' }}</td>
            </tr>
          </table>
        </div>

        <!-- Pesos Verde -->
        <div class="info-section">
          <h3 class="section-title">‚öñÔ∏è Pesos Verde</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Peso Verde Final:</td>
              <td class="value-cell">{{ trilla.wverdeFinal ? (trilla.wverdeFinal + ' kg') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Peso Verde Te√≥rico:</td>
              <td class="value-cell">{{ trilla.wverdeTeorico ? (trilla.wverdeTeorico + ' kg') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Fecha Final Reposo:</td>
              <td class="value-cell">{{ formatearFecha(trilla.ffinalReposo) }}</td>
            </tr>
          </table>
        </div>

        <!-- Clasificaci√≥n de Caf√©s -->
        <div class="info-section">
          <h3 class="section-title">‚òï Clasificaci√≥n de Caf√©s</h3>
          <table class="info-table">
            <tr class="highlight-row">
              <td class="label-cell">Primera:</td>
              <td class="value-cell primary-value">{{ trilla.pprimera ? (trilla.pprimera + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Segundas:</td>
              <td class="value-cell">{{ trilla.psegundas ? (trilla.psegundas + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Caracolillo:</td>
              <td class="value-cell">{{ trilla.pcaracolillo ? (trilla.pcaracolillo + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Madres:</td>
              <td class="value-cell">{{ trilla.pmadres ? (trilla.pmadres + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Menudos:</td>
              <td class="value-cell">{{ trilla.pmenudos ? (trilla.pmenudos + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Inferiores:</td>
              <td class="value-cell">{{ trilla.pinferiores ? (trilla.pinferiores + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Cataduras:</td>
              <td class="value-cell">{{ trilla.pcataduras ? (trilla.pcataduras + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Barreduras:</td>
              <td class="value-cell">{{ trilla.pbarreduras ? (trilla.pbarreduras + '%') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Escogeduras:</td>
              <td class="value-cell">{{ trilla.pescogeduras ? (trilla.pescogeduras + '%') : '-' }}</td>
            </tr>
          </table>
        </div>

        <!-- Peso Verde (Exportaci√≥n) -->
        <div class="info-section" *ngIf="trilla.pesoVerde">
          <h3 class="section-title">üì¶ Peso Verde - Exportaci√≥n</h3>
          <table class="info-table">
            <tr>
              <td class="label-cell">Peso Inferiores:</td>
              <td class="value-cell">{{ trilla.pesoVerde.winferiores ? (trilla.pesoVerde.winferiores + ' kg') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Peso Final:</td>
              <td class="value-cell">{{ trilla.pesoVerde.wfinal ? (trilla.pesoVerde.wfinal + ' kg') : '-' }}</td>
            </tr>
            <tr>
              <td class="label-cell">Peso Final Inferiores:</td>
              <td class="value-cell">{{ trilla.pesoVerde.wFinalInferiores ? (trilla.pesoVerde.wFinalInferiores + ' kg') : '-' }}</td>
            </tr>
          </table>
        </div>
      </div>

      <div class="card-footer">
        <button class="btn-edit" (click)="editarRegistro(trilla.idTrilla)">‚úèÔ∏è Editar</button>
        <button class="btn-delete" (click)="eliminarRegistro(trilla.idTrilla)">üóëÔ∏è Eliminar</button>
      </div>
    </div>
  </div>
</div>
